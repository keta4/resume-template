# talk scripts

## FAQ

### Python

- Python スクリプト作成
  - 生ログなどの煩雑なデータを正規表現(先読み/後読み/(非)貪欲マッチ/後方参照)などで前処理(grep/perl/awk/Pandas)した後、計算を自動化(Pandas)
  - Excel シートを取得し、テキスト処理を自動化(OpenPyXL)

#### Python script 1

- システムであるタスクが開始してから完了するまでの時間を測定する必要がある(TAT測定)
- 生ログからタスクのIDを含む行のうち、開始時刻と終了時刻を含むログを抽出する
- 標準出力を整形し、開始時刻と終了時刻をcsvに吐き出す
- Pandas で csv を読み込む、このとき開始時刻と終了時刻の列を datetime 型にキャストする
- 開始時刻と終了時刻の差分の列を生成する

#### Python script 2

- そのプロジェクトでは、Excelの試験手順書に従って試験を実施する
- 試験実施後、その試験手順書に欄外追記を求められる
- 一部の試験手順では確認観点が明記されている
  - e.g. /etc/ssh/sshd_config AllowTcpForwarding yes/no
  - e.g. systemctl status sshd: サービス起動時間の変化
- その行と同じ行の欄外に、確認観点に対応するログを貼り付ける必要がある
- ユーザ企業が納品物として、ログの貼り付けなどを求めるので、やらざるを得ない
- 試験手順書は 1000 - 2000 行ぐらいある
- 確認観点はだいたい 10 - 20 個くらい
- 試験手順書を上から読み下して、確認観点を見つけたら、ログをフィルタして、貼り付けて、…を繰り返す
- 実際にやってみると、かなり苦痛な作業
- なぜ？
  - 余計な情報が多い
  - ほしいのは確認観点のテキストと、そのテキストの行番号だけ
  - つまり、1000 - 2000 行中ほしい行はたかだか 20 行程度
  - 確認観点のテキストを探す -> ログをフィルタする のコンテキストスイッチが多い
- 業務プロセスを変えよう
  - Excelのシートから、確認観点を表すテキストだけを抽出して、テキストファイルに吐き出したい
  - Excelのシートで、確認観点を表すテキストと同じ行の異なる列のセルに色を付けたい
  - 確認観点のテキストファイルを見て、確認観点ごとに対応するログをフィルタする
  - Excelのシートで、色のついたセルに該当するログを貼り付ける
- 何が変わった？
  - エビデンス整理作業全体としては、6 時間 -> 4 時間
  - ログ貼り付け 3 時間 -> 1 時間
  - エビデンス整理作業全体としては、処理速度が 1.5 倍上がった
  - ログ貼り付け作業としては、処理速度が 3 倍上がった




